const { 
  createMonthSlots, 
  createUserID, 
  setMissingUserIDs 
} = require('./lib.js');

describe('createUserID', () => {
  it('removes accents and switches to lower case', () => {
    expect(createUserID('Jorge Cárdenas')).toBe('jorge_cardenas');
  });

  it('removes all special chars', () => {
    expect(createUserID('Jorge Cárdenas*')).toBe('jorge_cardenas');
  });

  it('removes extra white space', () => {
    expect(createUserID('\tVerónica  Muñoz  \r\n')).toBe('veronica_munoz');
  });
});

describe('setMissingUserIDs', () => {
  it("sets user id to the rows that don't have one in a new array", () => {
    const rows = [
      {nombre: 'Julio Castro', id: 'jcastro', email: 'jcastro@mail.com'},
      {nombre: 'Víctor Sánchez', email: 'vsanchez@mail.com'},
      {nombre: 'Eduardo Nuñez', email: 'enunez@mail.com'},
    ]

    expected = [
      {nombre: 'Julio Castro', id: 'jcastro', email: 'jcastro@mail.com'},
      {nombre: 'Víctor Sánchez', id: 'victor_sanchez', email: 'vsanchez@mail.com'},
      {nombre: 'Eduardo Nuñez', id: 'eduardo_nunez', email: 'enunez@mail.com'},
    ]

    expect(setMissingUserIDs(rows)).toEqual(expected);
  });

  it('Handles users with same names', () => {
    const rows = [
      {nombre: 'Jorge Martinez', email: 'jmartinez@mail.com'},
      {nombre: 'Víctor Sánchez', email: 'vsanchez@mail.com'},
      {nombre: 'Eduardo Nuñez', email: 'enunez@mail.com'},
      {nombre: 'Jorge Martinez'},
    ]

    expected = [
      {nombre: 'Jorge Martinez', id: 'jorge_martinez', email: 'jmartinez@mail.com'},
      {nombre: 'Víctor Sánchez', id: 'victor_sanchez', email: 'vsanchez@mail.com'},
      {nombre: 'Eduardo Nuñez', id: 'eduardo_nunez', email: 'enunez@mail.com'},
      {nombre: 'Jorge Martinez', id: 'jorge_martinez1' },
    ]
    expect(setMissingUserIDs(rows)).toEqual(expected);
  })

});

describe('createMonthSlots', () => {
  it('should generate slots for November 2020', () => {
    const expected = [
      { hora: '06:00', dia: '02-Lun' },
      { hora: '07:00', dia: '02-Lun' },
      { hora: '08:00', dia: '02-Lun' },
      { hora: '09:30', dia: '02-Lun' },
      { hora: '11:00', dia: '02-Lun' },
      { hora: '12:00', dia: '02-Lun' },
      { hora: '17:00', dia: '02-Lun' },
      { hora: '18:00', dia: '02-Lun' },
      { hora: '19:00', dia: '02-Lun' },
      { hora: '06:00', dia: '03-Mar' },
      { hora: '07:00', dia: '03-Mar' },
      { hora: '08:00', dia: '03-Mar' },
      { hora: '09:30', dia: '03-Mar' },
      { hora: '11:00', dia: '03-Mar' },
      { hora: '12:00', dia: '03-Mar' },
      { hora: '17:00', dia: '03-Mar' },
      { hora: '18:00', dia: '03-Mar' },
      { hora: '19:00', dia: '03-Mar' },
      { hora: '06:00', dia: '04-Mié' },
      { hora: '07:00', dia: '04-Mié' },
      { hora: '08:00', dia: '04-Mié' },
      { hora: '09:30', dia: '04-Mié' },
      { hora: '11:00', dia: '04-Mié' },
      { hora: '12:00', dia: '04-Mié' },
      { hora: '17:00', dia: '04-Mié' },
      { hora: '18:00', dia: '04-Mié' },
      { hora: '19:00', dia: '04-Mié' },
      { hora: '06:00', dia: '05-Jue' },
      { hora: '07:00', dia: '05-Jue' },
      { hora: '08:00', dia: '05-Jue' },
      { hora: '09:30', dia: '05-Jue' },
      { hora: '11:00', dia: '05-Jue' },
      { hora: '12:00', dia: '05-Jue' },
      { hora: '17:00', dia: '05-Jue' },
      { hora: '18:00', dia: '05-Jue' },
      { hora: '19:00', dia: '05-Jue' },
      { hora: '06:00', dia: '06-Vie' },
      { hora: '07:00', dia: '06-Vie' },
      { hora: '08:00', dia: '06-Vie' },
      { hora: '09:30', dia: '06-Vie' },
      { hora: '11:00', dia: '06-Vie' },
      { hora: '12:00', dia: '06-Vie' },
      { hora: '17:00', dia: '06-Vie' },
      { hora: '18:00', dia: '06-Vie' },
      { hora: '19:00', dia: '06-Vie' },
      { hora: '06:00', dia: '07-Sáb' },
      { hora: '07:00', dia: '07-Sáb' },
      { hora: '08:00', dia: '07-Sáb' },
      { hora: '09:30', dia: '07-Sáb' },
      { hora: '11:00', dia: '07-Sáb' },
      { hora: '12:00', dia: '07-Sáb' },
      { hora: '17:00', dia: '07-Sáb' },
      { hora: '18:00', dia: '07-Sáb' },
      { hora: '19:00', dia: '07-Sáb' },
      { hora: '06:00', dia: '09-Lun' },
      { hora: '07:00', dia: '09-Lun' },
      { hora: '08:00', dia: '09-Lun' },
      { hora: '09:30', dia: '09-Lun' },
      { hora: '11:00', dia: '09-Lun' },
      { hora: '12:00', dia: '09-Lun' },
      { hora: '17:00', dia: '09-Lun' },
      { hora: '18:00', dia: '09-Lun' },
      { hora: '19:00', dia: '09-Lun' },
      { hora: '06:00', dia: '10-Mar' },
      { hora: '07:00', dia: '10-Mar' },
      { hora: '08:00', dia: '10-Mar' },
      { hora: '09:30', dia: '10-Mar' },
      { hora: '11:00', dia: '10-Mar' },
      { hora: '12:00', dia: '10-Mar' },
      { hora: '17:00', dia: '10-Mar' },
      { hora: '18:00', dia: '10-Mar' },
      { hora: '19:00', dia: '10-Mar' },
      { hora: '06:00', dia: '11-Mié' },
      { hora: '07:00', dia: '11-Mié' },
      { hora: '08:00', dia: '11-Mié' },
      { hora: '09:30', dia: '11-Mié' },
      { hora: '11:00', dia: '11-Mié' },
      { hora: '12:00', dia: '11-Mié' },
      { hora: '17:00', dia: '11-Mié' },
      { hora: '18:00', dia: '11-Mié' },
      { hora: '19:00', dia: '11-Mié' },
      { hora: '06:00', dia: '12-Jue' },
      { hora: '07:00', dia: '12-Jue' },
      { hora: '08:00', dia: '12-Jue' },
      { hora: '09:30', dia: '12-Jue' },
      { hora: '11:00', dia: '12-Jue' },
      { hora: '12:00', dia: '12-Jue' },
      { hora: '17:00', dia: '12-Jue' },
      { hora: '18:00', dia: '12-Jue' },
      { hora: '19:00', dia: '12-Jue' },
      { hora: '06:00', dia: '13-Vie' },
      { hora: '07:00', dia: '13-Vie' },
      { hora: '08:00', dia: '13-Vie' },
      { hora: '09:30', dia: '13-Vie' },
      { hora: '11:00', dia: '13-Vie' },
      { hora: '12:00', dia: '13-Vie' },
      { hora: '17:00', dia: '13-Vie' },
      { hora: '18:00', dia: '13-Vie' },
      { hora: '19:00', dia: '13-Vie' },
      { hora: '06:00', dia: '14-Sáb' },
      { hora: '07:00', dia: '14-Sáb' },
      { hora: '08:00', dia: '14-Sáb' },
      { hora: '09:30', dia: '14-Sáb' },
      { hora: '11:00', dia: '14-Sáb' },
      { hora: '12:00', dia: '14-Sáb' },
      { hora: '17:00', dia: '14-Sáb' },
      { hora: '18:00', dia: '14-Sáb' },
      { hora: '19:00', dia: '14-Sáb' },
      { hora: '06:00', dia: '16-Lun' },
      { hora: '07:00', dia: '16-Lun' },
      { hora: '08:00', dia: '16-Lun' },
      { hora: '09:30', dia: '16-Lun' },
      { hora: '11:00', dia: '16-Lun' },
      { hora: '12:00', dia: '16-Lun' },
      { hora: '17:00', dia: '16-Lun' },
      { hora: '18:00', dia: '16-Lun' },
      { hora: '19:00', dia: '16-Lun' },
      { hora: '06:00', dia: '17-Mar' },
      { hora: '07:00', dia: '17-Mar' },
      { hora: '08:00', dia: '17-Mar' },
      { hora: '09:30', dia: '17-Mar' },
      { hora: '11:00', dia: '17-Mar' },
      { hora: '12:00', dia: '17-Mar' },
      { hora: '17:00', dia: '17-Mar' },
      { hora: '18:00', dia: '17-Mar' },
      { hora: '19:00', dia: '17-Mar' },
      { hora: '06:00', dia: '18-Mié' },
      { hora: '07:00', dia: '18-Mié' },
      { hora: '08:00', dia: '18-Mié' },
      { hora: '09:30', dia: '18-Mié' },
      { hora: '11:00', dia: '18-Mié' },
      { hora: '12:00', dia: '18-Mié' },
      { hora: '17:00', dia: '18-Mié' },
      { hora: '18:00', dia: '18-Mié' },
      { hora: '19:00', dia: '18-Mié' },
      { hora: '06:00', dia: '19-Jue' },
      { hora: '07:00', dia: '19-Jue' },
      { hora: '08:00', dia: '19-Jue' },
      { hora: '09:30', dia: '19-Jue' },
      { hora: '11:00', dia: '19-Jue' },
      { hora: '12:00', dia: '19-Jue' },
      { hora: '17:00', dia: '19-Jue' },
      { hora: '18:00', dia: '19-Jue' },
      { hora: '19:00', dia: '19-Jue' },
      { hora: '06:00', dia: '20-Vie' },
      { hora: '07:00', dia: '20-Vie' },
      { hora: '08:00', dia: '20-Vie' },
      { hora: '09:30', dia: '20-Vie' },
      { hora: '11:00', dia: '20-Vie' },
      { hora: '12:00', dia: '20-Vie' },
      { hora: '17:00', dia: '20-Vie' },
      { hora: '18:00', dia: '20-Vie' },
      { hora: '19:00', dia: '20-Vie' },
      { hora: '06:00', dia: '21-Sáb' },
      { hora: '07:00', dia: '21-Sáb' },
      { hora: '08:00', dia: '21-Sáb' },
      { hora: '09:30', dia: '21-Sáb' },
      { hora: '11:00', dia: '21-Sáb' },
      { hora: '12:00', dia: '21-Sáb' },
      { hora: '17:00', dia: '21-Sáb' },
      { hora: '18:00', dia: '21-Sáb' },
      { hora: '19:00', dia: '21-Sáb' },
      { hora: '06:00', dia: '23-Lun' },
      { hora: '07:00', dia: '23-Lun' },
      { hora: '08:00', dia: '23-Lun' },
      { hora: '09:30', dia: '23-Lun' },
      { hora: '11:00', dia: '23-Lun' },
      { hora: '12:00', dia: '23-Lun' },
      { hora: '17:00', dia: '23-Lun' },
      { hora: '18:00', dia: '23-Lun' },
      { hora: '19:00', dia: '23-Lun' },
      { hora: '06:00', dia: '24-Mar' },
      { hora: '07:00', dia: '24-Mar' },
      { hora: '08:00', dia: '24-Mar' },
      { hora: '09:30', dia: '24-Mar' },
      { hora: '11:00', dia: '24-Mar' },
      { hora: '12:00', dia: '24-Mar' },
      { hora: '17:00', dia: '24-Mar' },
      { hora: '18:00', dia: '24-Mar' },
      { hora: '19:00', dia: '24-Mar' },
      { hora: '06:00', dia: '25-Mié' },
      { hora: '07:00', dia: '25-Mié' },
      { hora: '08:00', dia: '25-Mié' },
      { hora: '09:30', dia: '25-Mié' },
      { hora: '11:00', dia: '25-Mié' },
      { hora: '12:00', dia: '25-Mié' },
      { hora: '17:00', dia: '25-Mié' },
      { hora: '18:00', dia: '25-Mié' },
      { hora: '19:00', dia: '25-Mié' },
      { hora: '06:00', dia: '26-Jue' },
      { hora: '07:00', dia: '26-Jue' },
      { hora: '08:00', dia: '26-Jue' },
      { hora: '09:30', dia: '26-Jue' },
      { hora: '11:00', dia: '26-Jue' },
      { hora: '12:00', dia: '26-Jue' },
      { hora: '17:00', dia: '26-Jue' },
      { hora: '18:00', dia: '26-Jue' },
      { hora: '19:00', dia: '26-Jue' },
      { hora: '06:00', dia: '27-Vie' },
      { hora: '07:00', dia: '27-Vie' },
      { hora: '08:00', dia: '27-Vie' },
      { hora: '09:30', dia: '27-Vie' },
      { hora: '11:00', dia: '27-Vie' },
      { hora: '12:00', dia: '27-Vie' },
      { hora: '17:00', dia: '27-Vie' },
      { hora: '18:00', dia: '27-Vie' },
      { hora: '19:00', dia: '27-Vie' },
      { hora: '06:00', dia: '28-Sáb' },
      { hora: '07:00', dia: '28-Sáb' },
      { hora: '08:00', dia: '28-Sáb' },
      { hora: '09:30', dia: '28-Sáb' },
      { hora: '11:00', dia: '28-Sáb' },
      { hora: '12:00', dia: '28-Sáb' },
      { hora: '17:00', dia: '28-Sáb' },
      { hora: '18:00', dia: '28-Sáb' },
      { hora: '19:00', dia: '28-Sáb' },
      { hora: '06:00', dia: '30-Lun' },
      { hora: '07:00', dia: '30-Lun' },
      { hora: '08:00', dia: '30-Lun' },
      { hora: '09:30', dia: '30-Lun' },
      { hora: '11:00', dia: '30-Lun' },
      { hora: '12:00', dia: '30-Lun' },
      { hora: '17:00', dia: '30-Lun' },
      { hora: '18:00', dia: '30-Lun' },
      { hora: '19:00', dia: '30-Lun' }
    ];

    expect(createMonthSlots(2020, 11)).toEqual(expected);
  });
});
